" Configure Pathogen
call pathogen#infect()
call pathogen#helptags()

" Syntax HL and indentation
syntax on
filetype plugin indent on
set et bs=2 ts=4 sts=4 sw=4

" Configure NERDTree
let NERDTreeIgnore = ['\.pyc$']
nmap <F7> :NERDTreeToggle<CR>

" Configure vim-airline
let g:airline_powerline_fonts = 1
set laststatus=2

" Text colours and encoding
set t_Co=256
set encoding=utf-8

" Extra settings
set wildchar=<Tab> wildmenu wildmode=full
set number
set hlsearch
set incsearch

" Extra keymappings
nmap <F8> :!grep % -e "^\s*class \\|^\s*def "<CR>
nmap <F5> :exec "?\\(<C-R><C-W>\\s*=" . '\\|' . "\\(class" . '\\|' . "def\\).*<C-R><C-W>.*:\\)"<CR>
nmap <F4> :Ack <C-R><C-W> <CR>
nmap <F3> :!pygt <C-R><C-W> <CR>
vmap <F3> "py:<C-W>!pygt "<C-R>p" <CR>
nmap <F2> mm:%s/<C-R><C-W>//gc<LEFT><LEFT><LEFT>
nmap n nzz
nmap N Nzz

nmap gd md?def <C-R><C-W>(<CR>:noh<CR>
nmap gc mc?class <C-R><C-W>[(:]<CR>:noh<CR>

map <C-h> <C-w>h
map <C-j> <C-w>j
map <C-k> <C-w>k
map <C-l> <C-w>l

" Fugitive commands
command! Gadd exec "Git add -p"
command! -nargs=* Ggraph exec "Git graph " . <q-args>
command! -nargs=? Gpush exec join(["Git push", len(<q-args>)==0?"origin":<q-args>, system("git rev-parse --abbrev-ref HEAD")], " ")[0:-2]

" Colourscheme changes to make vimdiff readable
hi DiffDelete ctermfg=DarkRed
hi DiffText ctermbg=DarkGrey
hi DiffAdd cterm=bold ctermbg=DarkGreen
hi DiffChange cterm=inverse
hi Visual cterm=inverse

" autocmd
if has("autocmd")
    autocmd BufReadPost fugitive://* set bufhidden=delete
endif
